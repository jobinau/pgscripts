#Generated using the following command 
# kubectl get postgresclusters hippo-s3 -o yaml > Crunchy_pgclsuter_cr.yml
# Consider only the "spec" section for reference
apiVersion: postgres-operator.crunchydata.com/v1beta1
kind: PostgresCluster
metadata:
  name: hippo-s3
  namespace: crunchypgo
spec:
  backups:
    pgbackrest:
      configuration:
      - secret:
          name: pgo-s3-creds    #kubectl get secret pgo-s3-creds -o go-template='{{range $k,$v := .data}}{{"\n"}}{{$k}}: {{$v | base64decode}}{{end}}{{"\n"}}'
      global:
        archive-async: "y"
        compress-type: gz
        process-max: "4"
        repo1-bundle: "y"
        repo1-bundle-limit: 100MiB
        repo1-bundle-size: 200MiB
        repo1-path: /pgbackrest/postgres-operator/hippo-s3/repo1
        repo1-retention-full: "2"
        repo1-retention-full-type: count
        repo1-s3-uri-style: path
        repo1-s3-verify-tls: "n"
        spool-path: /pgdata
      repos:
      - name: repo1
        s3:
          bucket: pg2
          endpoint: 192.168.48.1:9000
          region: us-east-1
        schedules:
          full: '*/10 * * * *'
  instances:
  - dataVolumeClaimSpec:
      accessModes:
      - ReadWriteOnce
      resources:
        requests:
          storage: 1Gi
    name: ""
    replicas: 2
  port: 5432
  postgresVersion: 17
  proxy:
    pgBouncer:
      config:
        global:
          pool_mode: transaction
      port: 5432
      replicas: 3
      service:
        type: LoadBalancer
  service:
    type: LoadBalancer
